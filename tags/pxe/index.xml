<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PXE on Caisong's Blog</title><link>https://caisong.github.io/tags/pxe/</link><description>Recent content in PXE on Caisong's Blog</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Wed, 22 May 2024 21:41:19 +0800</lastBuildDate><atom:link href="https://caisong.github.io/tags/pxe/index.xml" rel="self" type="application/rss+xml"/><item><title>PXELiveCD</title><link>https://caisong.github.io/posts/pxelivecd/</link><pubDate>Wed, 22 May 2024 21:41:19 +0800</pubDate><guid>https://caisong.github.io/posts/pxelivecd/</guid><description>&lt;p>基于linux live cd 镜像，使用pxe批量安装&lt;/p>
&lt;h2 id="主要流程">主要流程&lt;/h2>
&lt;p>** 个人理解，不一定准确 **&lt;/p>
&lt;ol>
&lt;li>使用DHCP 引导入PXE&lt;/li>
&lt;li>PXE 使用tftp 引导syslinux？&lt;/li>
&lt;li>加载nfs或http的系统&lt;/li>
&lt;/ol>
&lt;h1 id="virtualbox环境配置">virtualbox环境配置&lt;/h1>
&lt;p>主要就是必须保证pxe server 和client在同一网段。（dhcp支持replay的忽略）
pxe server 使用两张网卡，一张nat用于下载包，一张内部网络
pxe client 使用一张网卡，使用内部网络。
也可以使用host-only模式，但是要关闭dhcp服务，因为pxe server要作为dhcp服务引导pxe。&lt;/p>
&lt;h2 id="注意事项">注意事项&lt;/h2>
&lt;ol>
&lt;li>关闭防火墙&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>systemctl stop firewalld
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>禁用selinux&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>setenforce &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="部署流程">部署流程&lt;/h2>
&lt;ol>
&lt;li>安装tftp
&lt;strong>tftp支持xinet.d启动和systemctl启动，只能用一个，建议&lt;code>systemctl&lt;/code>&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dnf install tftp-server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># tftp-server 路径挂载在/var/lib/tftpboot，服务路径使用systemctl status查看&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>pxe相关内容安装至tftp挂载路径&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 这个包直接建syslinux相关内容放在/tftpboot目录下了（出现过直接放在/var/lib/tftpboot的，自己查看下。最终都要拷贝到自己的挂载路径。）&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dnf install syslinux-tftpboot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>安装dhcp
&lt;code>dhcp&lt;/code>是引导pxe的关键，其实如果客户端使用ipxe，也能不使用&lt;code>dhcp&lt;/code>，目前还有&lt;code>uefi&lt;/code>的方式，暂未研究。
不用使用dnsmasq，没配置出来。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dnf install dhcpd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">allow bootp;
allow booting;
max-lease-time 1200;
default-lease-time 900;
log-facility local7;

option ip-forwarding false;
option mask-supplier false;
#192.168.10.1 pxe server的ip
 subnet 192.168.10.0 netmask 255.255.255.0 {
 option routers 192.168.10.1;
 option domain-name-servers 127.0.0.1;
 range 192.168.10.100 192.168.10.200;
 next-server 192.168.10.1;
 filename &amp;#34;pxelinux.0&amp;#34;;
 }
&lt;/code>&lt;/pre>&lt;ol start="3">
&lt;li>安装httpd或nfs&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dnf install httpd nfs-utils
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>httpd默认root目录是/var/www/html
想偷懒的，直接将iso镜像挂载到该目录。&lt;/p></description></item></channel></rss>