<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>运维 on Caisong's Blog</title><link>https://caisong.github.io/categories/%E8%BF%90%E7%BB%B4/</link><description>Recent content in 运维 on Caisong's Blog</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Fri, 27 Dec 2024 21:40:34 +0800</lastBuildDate><atom:link href="https://caisong.github.io/categories/%E8%BF%90%E7%BB%B4/index.xml" rel="self" type="application/rss+xml"/><item><title>Centos更新rsyslog</title><link>https://caisong.github.io/posts/centos%E6%9B%B4%E6%96%B0rsyslog/</link><pubDate>Fri, 27 Dec 2024 21:40:34 +0800</pubDate><guid>https://caisong.github.io/posts/centos%E6%9B%B4%E6%96%B0rsyslog/</guid><description>&lt;p>centos 7 默认不携带mmnormlize这个module,需要额外安装&lt;/p></description></item><item><title>Rsyslog 问题记录</title><link>https://caisong.github.io/posts/rsyslog%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</link><pubDate>Tue, 24 Dec 2024 21:42:22 +0800</pubDate><guid>https://caisong.github.io/posts/rsyslog%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</guid><description>&lt;p>Cut out summary from your post content here.&lt;/p></description></item><item><title>Apache webdav配置</title><link>https://caisong.github.io/posts/apachewebdav%E9%85%8D%E7%BD%AE/</link><pubDate>Tue, 24 Dec 2024 21:40:28 +0800</pubDate><guid>https://caisong.github.io/posts/apachewebdav%E9%85%8D%E7%BD%AE/</guid><description>&lt;p>apache webdav配置&lt;/p></description></item><item><title>Kill zombie</title><link>https://caisong.github.io/posts/killzombie/</link><pubDate>Wed, 09 Oct 2024 21:41:03 +0800</pubDate><guid>https://caisong.github.io/posts/killzombie/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ps -A -o stat,ppid,pid,cmd | grep -e &lt;span style="color:#e6db74">&amp;#39;^[Zz]&amp;#39;&lt;/span> | awk &lt;span style="color:#e6db74">&amp;#39;{print $2}&amp;#39;&lt;/span> | xargs kill -9
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Alpine vsftp搭建</title><link>https://caisong.github.io/posts/alpinevsftp%E6%90%AD%E5%BB%BA/</link><pubDate>Thu, 18 Jul 2024 21:42:06 +0800</pubDate><guid>https://caisong.github.io/posts/alpinevsftp%E6%90%AD%E5%BB%BA/</guid><description>&lt;p>alpine 搭建 vsftp 配置&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">anonymous_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">dirmessage_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">connect_from_port_20&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">listen&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">local_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">chroot_local_user&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">allow_writeable_chroot&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">background&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">ftpd_banner&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">Welcome to FTP Server&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">dirmessage_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">max_clients&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">10&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">max_per_ip&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">write_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">local_umask&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">022&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">passwd_chroot_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">listen_ipv6&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">seccomp_sandbox&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">log_ftp_protocol&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_std_format&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">dual_log_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/var/log/vsftpd/xferlog.log&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">vsftpd_log_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/var/log/vsftpd/vsftpd.log&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>创建用户&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>addgroup -S ftpuser
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>adduser -D -G ftpuser -h /home/vsftpd/ftpuser -s /bin/false ftpuser
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir -p /home/vsftpd/ftpuser
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chown -R ftpuser:ftpuser /home/vs
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$FTP_USER&lt;span style="color:#e6db74">:&lt;/span>$FTP_PASS&lt;span style="color:#e6db74">&amp;#34;&lt;/span> | /usr/sbin/chpasswd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>启动服务&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rc-service vsftpd start
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Salt docker cluster</title><link>https://caisong.github.io/posts/saltdockercluster/</link><pubDate>Tue, 16 Jul 2024 21:42:23 +0800</pubDate><guid>https://caisong.github.io/posts/saltdockercluster/</guid><description>&lt;p>salt docker cluster dockerfile&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">master&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">saltstack/salt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hostname&lt;/span>: &lt;span style="color:#ae81ff">salt-master&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">60080&lt;/span>:&lt;span style="color:#ae81ff">8000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>: 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">SALT_MASTER_CONFIG={&amp;#34;netapi_enable_clients&amp;#34;:[&amp;#34;local&amp;#34;, &amp;#34;local_aysnc&amp;#34;, &amp;#34;local_batch&amp;#34;, &amp;#34;local_subset&amp;#34;, &amp;#34;runner&amp;#34;, &amp;#34;wheel&amp;#34;, &amp;#34;runner_async&amp;#34;], &amp;#34;file_roots&amp;#34;:{&amp;#34;base&amp;#34;:[&amp;#34;/srv/salt&amp;#34;], &amp;#34;formula&amp;#34;:[&amp;#34;/srv/formula/my-formula-0.0.2&amp;#34;]}}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./srv:/srv&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">backend&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">minion1&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">saltstack/salt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hostname&lt;/span>: &lt;span style="color:#ae81ff">minion1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">SALT_MINION_CONFIG={&amp;#34;master&amp;#34;:&amp;#34;salt-master&amp;#34;}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">backend&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">minion2&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">saltstack/salt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hostname&lt;/span>: &lt;span style="color:#ae81ff">minion2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">SALT_MINION_CONFIG={&amp;#34;master&amp;#34;:&amp;#34;salt-master&amp;#34;}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">backend&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">backend&lt;/span>:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Opetelemetry web页面信息上报</title><link>https://caisong.github.io/posts/opetelemetry/</link><pubDate>Tue, 18 Jun 2024 21:41:16 +0800</pubDate><guid>https://caisong.github.io/posts/opetelemetry/</guid><description>&lt;p>opetelemetry目前还没有直接的web js的组件，尝试将nodejs的打包，实现页面的监控&lt;/p>
&lt;ul>
&lt;li>基于nodejs创建信息上报脚本&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// auto.js
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">WebTracerProvider&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;@opentelemetry/sdk-trace-web&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">getWebAutoInstrumentations&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;@opentelemetry/auto-instrumentations-web&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// const { CollectorTraceExporter } = require(&amp;#39;@opentelemetry/exporter-collector&amp;#39;);
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// const { OTLPTraceExporter } = require(&amp;#39;@opentelemetry/exporter-trace-otlp-http&amp;#39;);
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">ConsoleSpanExporter&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;@opentelemetry/sdk-trace-base&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">SimpleSpanProcessor&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;@opentelemetry/sdk-trace-base&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">registerInstrumentations&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;@opentelemetry/instrumentation&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">ZoneContextManager&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;@opentelemetry/context-zone&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">B3Propagator&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;@opentelemetry/propagator-b3&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">collectorOptions&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// url: &amp;#39;&amp;lt;opentelemetry-collector-url&amp;gt;&amp;#39;, // url is optional and can be omitted - default is http://localhost:4318/v1/traces
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">headers&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Content-Type&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;application/json&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Origin&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;*&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Methods&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;GET, POST, OPTIONS&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Headers&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Content-Type, Authorization&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#75715e">// an optional object containing custom headers to be sent with each request
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">concurrencyLimit&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>, &lt;span style="color:#75715e">// an optional limit on pending requests
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">exporter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">ConsoleSpanExporter&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// const exporter = new OTLPTraceExporter(collectorOptions);
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">provider&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">WebTracerProvider&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">provider&lt;/span>.&lt;span style="color:#a6e22e">addSpanProcessor&lt;/span>(&lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">SimpleSpanProcessor&lt;/span>(&lt;span style="color:#a6e22e">exporter&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">provider&lt;/span>.&lt;span style="color:#a6e22e">register&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">contextManager&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">ZoneContextManager&lt;/span>(),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">propagator&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">B3Propagator&lt;/span>(),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">registerInstrumentations&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instrumentations&lt;/span>&lt;span style="color:#f92672">:&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">getWebAutoInstrumentations&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// load custom configuration for xml-http-request instrumentation
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#e6db74">&amp;#39;@opentelemetry/instrumentation-xml-http-request&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">clearTimingResources&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>nodejs 转 web js&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>npx browserify auto.js -o bundle-auto.js
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>jaeger 接收端&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>docker run --rm --name jaeger -p 6831:6831/udp -p 6832:6832/udp -p 5778:5778 -p 16686:16686 -p 4317:4317 -p 4318:4318 -p 14250:14250 -p 14268:14268 -p 14269:14269 -d jaegertracing/all-in-one
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>环境变量&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>export JAVA_TOOL_OPTIONS=&amp;#34;-javaagent:/data/software/opentelemetry-javaagent.jar&amp;#34; OTEL_TRACES_EXPORTER=logging OTEL_METRICS_EXPORTER=logging OTEL_LOGS_EXPORTER=logging OTEL_METRIC_EXPORT_INTERVAL=150000 OTEL_PROPAGATORS=b3multi OTEL_TRACES_SAMPLER=always_off
&lt;/code>&lt;/pre>&lt;p>&lt;strong>js使用&lt;code>propagate b3&lt;/code>将&lt;code>traceID&lt;/code>相关信息写在头文件中，java后端必须配置&lt;code>OTEL_PROPAGATORS=b3multi OTEL_TRACES_SAMPLER=always_off&lt;/code>环境变量才能获取&lt;/strong>&lt;/p></description></item><item><title>运维管理分发</title><link>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E5%88%86%E5%8F%91/</link><pubDate>Mon, 03 Jun 2024 21:41:53 +0800</pubDate><guid>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E5%88%86%E5%8F%91/</guid><description>&lt;p>运维分发工具,记录下。后期使用了再补充。&lt;/p></description></item><item><title>PXELiveCD</title><link>https://caisong.github.io/posts/pxelivecd/</link><pubDate>Wed, 22 May 2024 21:41:19 +0800</pubDate><guid>https://caisong.github.io/posts/pxelivecd/</guid><description>&lt;p>基于linux live cd 镜像，使用pxe批量安装&lt;/p>
&lt;h2 id="主要流程">主要流程&lt;/h2>
&lt;p>** 个人理解，不一定准确 **&lt;/p>
&lt;ol>
&lt;li>使用DHCP 引导入PXE&lt;/li>
&lt;li>PXE 使用tftp 引导syslinux？&lt;/li>
&lt;li>加载nfs或http的系统&lt;/li>
&lt;/ol>
&lt;h1 id="virtualbox环境配置">virtualbox环境配置&lt;/h1>
&lt;p>主要就是必须保证pxe server 和client在同一网段。（dhcp支持replay的忽略）
pxe server 使用两张网卡，一张nat用于下载包，一张内部网络
pxe client 使用一张网卡，使用内部网络。
也可以使用host-only模式，但是要关闭dhcp服务，因为pxe server要作为dhcp服务引导pxe。&lt;/p>
&lt;h2 id="注意事项">注意事项&lt;/h2>
&lt;ol>
&lt;li>关闭防火墙&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>systemctl stop firewalld
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>禁用selinux&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>setenforce &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="部署流程">部署流程&lt;/h2>
&lt;ol>
&lt;li>安装tftp
&lt;strong>tftp支持xinet.d启动和systemctl启动，只能用一个，建议&lt;code>systemctl&lt;/code>&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dnf install tftp-server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># tftp-server 路径挂载在/var/lib/tftpboot，服务路径使用systemctl status查看&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>pxe相关内容安装至tftp挂载路径&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 这个包直接建syslinux相关内容放在/tftpboot目录下了（出现过直接放在/var/lib/tftpboot的，自己查看下。最终都要拷贝到自己的挂载路径。）&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dnf install syslinux-tftpboot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>安装dhcp
&lt;code>dhcp&lt;/code>是引导pxe的关键，其实如果客户端使用ipxe，也能不使用&lt;code>dhcp&lt;/code>，目前还有&lt;code>uefi&lt;/code>的方式，暂未研究。
不用使用dnsmasq，没配置出来。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dnf install dhcpd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">allow bootp;
allow booting;
max-lease-time 1200;
default-lease-time 900;
log-facility local7;

option ip-forwarding false;
option mask-supplier false;
#192.168.10.1 pxe server的ip
 subnet 192.168.10.0 netmask 255.255.255.0 {
 option routers 192.168.10.1;
 option domain-name-servers 127.0.0.1;
 range 192.168.10.100 192.168.10.200;
 next-server 192.168.10.1;
 filename &amp;#34;pxelinux.0&amp;#34;;
 }
&lt;/code>&lt;/pre>&lt;ol start="3">
&lt;li>安装httpd或nfs&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dnf install httpd nfs-utils
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>httpd默认root目录是/var/www/html
想偷懒的，直接将iso镜像挂载到该目录。&lt;/p></description></item><item><title>运维接口</title><link>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E6%8E%A5%E5%8F%A3/</link><pubDate>Sun, 22 Oct 2023 21:41:54 +0800</pubDate><guid>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E6%8E%A5%E5%8F%A3/</guid><description>&lt;p>考虑如何上报运维数据，未落地方案&lt;/p></description></item><item><title>L2TP部署</title><link>https://caisong.github.io/posts/l2tp/</link><pubDate>Wed, 28 Sep 2022 21:41:05 +0800</pubDate><guid>https://caisong.github.io/posts/l2tp/</guid><description>&lt;h2 id="l2tp服务端">L2TP服务端&lt;/h2>
&lt;ol>
&lt;li>内核加载&lt;code>modprobe af_key&lt;/code>&lt;/li>
&lt;li>配置文件&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cat &amp;gt; vpn.env &lt;span style="color:#e6db74">&amp;lt;&amp;lt; EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">VPN_IPSEC_PSK=random
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">VPN_USER=caisong
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">VPN_PASSWORD=123456
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>l2tp容器&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 容器内通信，不需要对外连接&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run --name l2tp-vpn-server --env-file ./vpn.env -p 500:500/udp -p 4500:4500/udp -v /lib/modules:/lib/modules:ro -d --privileged hwdsl2/ipsec-vpn-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="l2tp客户端">L2TP客户端&lt;/h2>
&lt;ol>
&lt;li>centos基础镜像&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 必须挂载module，容器里没有&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run -itd -v /lib/modules:/lib/modules:ro --privileged centos:8 /sbin/init
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>客户端配置&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 容器镜像不带这些module，安装软件会有依赖。直接先把依赖的module安装完成后，再这个镜像基础上再安装l2tp客户端&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dnf install xl2tpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_SERVER_IP&lt;span style="color:#f92672">=&lt;/span>random 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_IPSEC_PSK&lt;span style="color:#f92672">=&lt;/span>172.17.0.2 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_USERNAME&lt;span style="color:#f92672">=&lt;/span>caisong
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_PASSWORD&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">123456&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>/etc/xl2tpd/xl2tpd.conf&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cat &amp;gt; /etc/xl2tpd/xl2tpd.conf &lt;span style="color:#e6db74">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">[lac myvpn]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">lns = $VPN_SERVER_IP
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">ppp debug = yes
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">pppoptfile = /etc/ppp/options.l2tpd.client
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">length bit = yes
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>/etc/ppp/options.l2tpd.client&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cat &amp;gt; /etc/ppp/options.l2tpd.client &lt;span style="color:#e6db74">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">ipcp-accept-local
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">ipcp-accept-remote
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">refuse-eap
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">require-chap
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">noccp
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">noauth
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">mtu 1280
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">mru 1280
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">noipdefault
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">defaultroute
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">usepeerdns
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">connect-delay 5000
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">name $VPN_USER
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">password $VPN_PASSWORD
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Create xl2tpd control file:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>mkdir -p /var/run/xl2tpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>touch /var/run/xl2tpd/l2tp-control
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl start xl2tpd 
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Kafaka消费组管理</title><link>https://caisong.github.io/posts/kafaka%E6%B6%88%E8%B4%B9%E7%BB%84%E7%AE%A1%E7%90%86/</link><pubDate>Wed, 31 Aug 2022 21:41:03 +0800</pubDate><guid>https://caisong.github.io/posts/kafaka%E6%B6%88%E8%B4%B9%E7%BB%84%E7%AE%A1%E7%90%86/</guid><description>&lt;p>Cut out summary from your post content here.&lt;/p></description></item><item><title>自签HTTPS证书</title><link>https://caisong.github.io/posts/https%E8%AF%81%E4%B9%A6/</link><pubDate>Tue, 30 Aug 2022 21:40:59 +0800</pubDate><guid>https://caisong.github.io/posts/https%E8%AF%81%E4%B9%A6/</guid><description>&lt;h1 id="https证书">HTTPS证书&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo openssl req -x509 -nodes -days &lt;span style="color:#ae81ff">365&lt;/span> -newkey rsa:2048 -keyout /etc/ssl/private/nginx-selfsigned.key -out /etc/ssl/certs/nginx-selfsigned.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Alpinek8s安装</title><link>https://caisong.github.io/posts/alpinek8s%E5%AE%89%E8%A3%85/</link><pubDate>Thu, 17 Mar 2022 21:40:27 +0800</pubDate><guid>https://caisong.github.io/posts/alpinek8s%E5%AE%89%E8%A3%85/</guid><description>&lt;h2 id="alpine-k8s安装">alpine k8s安装&lt;/h2>
&lt;p>&lt;a href="https://dev.to/xphoniex/how-to-create-a-kubernetes-cluster-on-alpine-linux-kcg">安装参考&lt;/a>&lt;/p>
&lt;h3 id="配置vagrant">配置vagrant&lt;/h3>
&lt;p>略&lt;/p>
&lt;h3 id="master节点安装">master节点安装&lt;/h3>
&lt;ol>
&lt;li>添加edge软件源&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>https://mirrors.ustc.edu.cn/alpine/latest-stable/main
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>https://mirrors.ustc.edu.cn/alpine/latest-stable/community
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>@testing http://mirrors.ustc.edu.cn/alpine/edge/testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>@community http://mirrors.ustc.edu.cn/alpine/edge/community
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>apk更新后，重启，否则docker启动失败，报iptables相关错误&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 重启后失败再尝试以下命令&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo modprobe ip_tables
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo echo &lt;span style="color:#e6db74">&amp;#39;ip_tables&amp;#39;&lt;/span> &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>安装软件包&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># mater节点&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add kubernetes@testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add docker@community
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add cni-plugins@testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add kubelet@testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># node节点&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add docker@community
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add kubelet@testing
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>kubeadm init 的时候指定镜像源&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 先查看IP和kubernetes的版本&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kubeadm version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># init的时候指定registry源&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo kubeadm init --kubernetes-version&lt;span style="color:#f92672">=&lt;/span>v1.23.4 --image-repository registry.aliyuncs.com/google_containers --apiserver-advertise-address&lt;span style="color:#f92672">=&lt;/span>192.168.33.10
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>记录命令执行后返回的结果&lt;/p></description></item><item><title>Repo源制作</title><link>https://caisong.github.io/posts/repo%E6%BA%90%E5%88%B6%E4%BD%9C/</link><pubDate>Wed, 29 Dec 2021 21:41:25 +0800</pubDate><guid>https://caisong.github.io/posts/repo%E6%BA%90%E5%88%B6%E4%BD%9C/</guid><description>&lt;h1 id="repo源制作">repo源制作&lt;/h1>
&lt;p>制作源最好找一台什么都没装的虚拟机，或者&lt;code>docker&lt;/code>拉一个原始镜像，不然要制作的软件依赖包可能缺失。&lt;/p>
&lt;ol>
&lt;li>下载软件包及依赖&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum install yum-plugin-downloadonly
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 下载nano为例&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yum install --downloadonly --downloaddir&lt;span style="color:#f92672">=&lt;/span>/root/package/nano nano
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>不加&amp;ndash;downloaddir参数，CentOS 7下载的依赖包会放在默认路径*/var/cache/yum/x86_64/7/base/packages*下。&lt;/p>
&lt;ol start="2">
&lt;li>制作源&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>yum install createrepo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd &amp;lt;rpm安装包目录&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>createrepo .
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>制作repo
RHEL默认releaserver为版本号+server，如AS6U4的releaseServer为6Server；CentOS直接使用版本号,如6、7。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cat &amp;gt; /etc/yum.repos.d/&amp;lt;your_repo_name.repo&amp;gt; &lt;span style="color:#e6db74">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">[repo-name]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">name=&amp;lt;repo name&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">baseurl=file:///&amp;lt;rpm direcotry&amp;gt;/\$releaserver/
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">enabled=1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">gpgcheck=0
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Alpine无法使用minikube，具体原因未知</title><link>https://caisong.github.io/posts/alpine%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8minikube%E5%85%B7%E4%BD%93%E5%8E%9F%E5%9B%A0%E6%9C%AA%E7%9F%A5/</link><pubDate>Tue, 21 Dec 2021 21:42:07 +0800</pubDate><guid>https://caisong.github.io/posts/alpine%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8minikube%E5%85%B7%E4%BD%93%E5%8E%9F%E5%9B%A0%E6%9C%AA%E7%9F%A5/</guid><description>&lt;p>使用alpine镜像构建ks8 minikube集群&lt;/p></description></item><item><title>python远程控制 自动化部署</title><link>https://caisong.github.io/posts/fabric%E8%BD%BB%E9%87%8F%E8%BF%9C%E7%AB%AF%E9%83%A8%E7%BD%B2/</link><pubDate>Fri, 03 Sep 2021 21:42:11 +0800</pubDate><guid>https://caisong.github.io/posts/fabric%E8%BD%BB%E9%87%8F%E8%BF%9C%E7%AB%AF%E9%83%A8%E7%BD%B2/</guid><description>&lt;ul>
&lt;li>fabric：轻量远端部署&lt;/li>
&lt;li>ShutIt：基于python的expect库&lt;/li>
&lt;li>Ansible：自动化部署&lt;/li>
&lt;li>saltstack：自动化部署&lt;/li>
&lt;li>Puppet：自动化配置管理工具（Ruby）&lt;/li>
&lt;/ul></description></item><item><title>Ipv6地址设定</title><link>https://caisong.github.io/posts/ipv6%E5%9C%B0%E5%9D%80%E8%AE%BE%E5%AE%9A/</link><pubDate>Fri, 03 Sep 2021 21:41:59 +0800</pubDate><guid>https://caisong.github.io/posts/ipv6%E5%9C%B0%E5%9D%80%E8%AE%BE%E5%AE%9A/</guid><description>&lt;p>Cut out summary from your post content here.&lt;/p></description></item><item><title>Rsh 配置</title><link>https://caisong.github.io/posts/rsh%E9%85%8D%E7%BD%AE/</link><pubDate>Fri, 03 Sep 2021 21:41:26 +0800</pubDate><guid>https://caisong.github.io/posts/rsh%E9%85%8D%E7%BD%AE/</guid><description>&lt;p>基于LTP做测试用的，现在rsh较少使用了，仅记录&lt;/p>
&lt;ol>
&lt;li>安装xinetd&lt;/li>
&lt;li>添加rsh rexec rlogin 至/etc/securetty (root权限问题参考其他文档)&lt;/li>
&lt;li>配置conf文件，位于/etc/xinetd.d/&lt;/li>
&lt;li>配置hosts&lt;/li>
&lt;li>添加“machine_name user_name” &amp;raquo; ~/.rhosts&lt;/li>
&lt;li>重启服务&lt;/li>
&lt;/ol></description></item><item><title>Minikube 部署</title><link>https://caisong.github.io/posts/minikube/</link><pubDate>Fri, 03 Sep 2021 21:41:11 +0800</pubDate><guid>https://caisong.github.io/posts/minikube/</guid><description>&lt;h1 id="minikube">minikube&lt;/h1>
&lt;p>&lt;a href="https://github.com/AliyunContainerService/minikube">https://github.com/AliyunContainerService/minikube&lt;/a>
&lt;a href="https://developer.aliyun.com/article/221687">https://developer.aliyun.com/article/221687&lt;/a>
&lt;a href="https://blog.csdn.net/wchbest/article/details/88873965">https://blog.csdn.net/wchbest/article/details/88873965&lt;/a>
&lt;a href="https://minikube.sigs.k8s.io/docs/start/">https://minikube.sigs.k8s.io/docs/start/&lt;/a>
&lt;a href="https://www.jianshu.com/p/a42eeb66a19c">https://www.jianshu.com/p/a42eeb66a19c&lt;/a>
&lt;a href="https://www.cnblogs.com/kazihuo/p/10184286.html">https://www.cnblogs.com/kazihuo/p/10184286.html&lt;/a>&lt;/p></description></item><item><title>Iptables 记录</title><link>https://caisong.github.io/posts/iptables/</link><pubDate>Fri, 03 Sep 2021 21:41:02 +0800</pubDate><guid>https://caisong.github.io/posts/iptables/</guid><description>&lt;p>The &lt;code>iptables&lt;/code> command will attempt a reverse lookup on ip addresses. This will produce exactly the behavior you describe. You can inhibit the reverse lookup with the -n flag, which is why I always list rules like this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>iptables -vnL
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This fact and many other useful tidbits can be found in the &lt;code>iptables&lt;/code> man page. The relevant section concerning &lt;code>-n&lt;/code> reads:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>-L, --list &lt;span style="color:#f92672">[&lt;/span>chain&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>List all rules in the selected chain. If no chain is selected, all chains
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>are listed. Like every other iptables command, it applies to the specified
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>table &lt;span style="color:#f92672">(&lt;/span>filter is the default&lt;span style="color:#f92672">)&lt;/span>, so NAT rules get listed by
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> iptables -t nat -n -L
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Please note that it is often used with the -n option, in order to avoid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>long reverse DNS lookups. It is legal to specify the -Z &lt;span style="color:#f92672">(&lt;/span>zero&lt;span style="color:#f92672">)&lt;/span> option as
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>well, in which &lt;span style="color:#66d9ef">case&lt;/span> the chain&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span> will be atomically listed and zeroed. The
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>exact output is affected by the other arguments given. The exact rules are
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>suppressed &lt;span style="color:#66d9ef">until&lt;/span> you use
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> iptables -L -v
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Tags:
iptables&lt;/p></description></item><item><title>Disable disk cache</title><link>https://caisong.github.io/posts/disablediskcache/</link><pubDate>Fri, 03 Sep 2021 21:40:38 +0800</pubDate><guid>https://caisong.github.io/posts/disablediskcache/</guid><description>&lt;p>disable disk cache&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>hdparm -W &lt;span style="color:#ae81ff">0&lt;/span> /dev/sda1 &lt;span style="color:#75715e">#disable&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hdparm -W &lt;span style="color:#ae81ff">1&lt;/span> /dev/sda1 &lt;span style="color:#75715e">#enable&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>django部署apache2</title><link>https://caisong.github.io/posts/apache/</link><pubDate>Sun, 01 Apr 2018 20:55:39 +0000</pubDate><guid>https://caisong.github.io/posts/apache/</guid><description>&lt;p>最近学习使用django，尝试部署至apache2。&lt;/p>
&lt;ol>
&lt;li>required env&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt-get install apache2 libapache2-mod-wsgi-py3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo pip install django
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>
&lt;p>拷贝目录至&lt;code>/var/www&lt;/code>(apache2的默认网站目录)，之前未拷贝，在其他目录尝试了几次都未成功。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>添加配置website&lt;/p>
&lt;ol>
&lt;li>
&lt;p>配置网站配置&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /etc/apache2/sites-avaliable/ &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> cp 000-default.conf yoursite.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>配置详情&lt;/p>
&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;VirtualHost&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">*:80&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	ServerName 127.0.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	ServerAdmin webmaster@localhost
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	# 网站根目录, 请根据自身目录配置，下同
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	DocumentRoot /var/www/web
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	#静态文件目录
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	Alias /static/ /var/www/web/static/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;Directory&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">/var/www/web/static&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		Require all granted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;/Directory&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	WSGIScriptAlias / /var/www/web/web/wsgi.py
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;Directory&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">/var/www/web/web&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;Files&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">wsgi.py&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		Require all granted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;/Files&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;/Directory&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;/VirtualHost&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>查看django wigi.py文件
默认生成的文件没有问题，不需要修改即可运行。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> os.path &lt;span style="color:#f92672">import&lt;/span> join, dirname,abspath
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> django.core.wsgi &lt;span style="color:#f92672">import&lt;/span> get_wsgi_application
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PROJECT_DIR &lt;span style="color:#f92672">=&lt;/span> dirname(dirname(abspath(__file__)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> sys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sys&lt;span style="color:#f92672">.&lt;/span>path&lt;span style="color:#f92672">.&lt;/span>insert(&lt;span style="color:#ae81ff">0&lt;/span>, PROJECT_DIR)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os&lt;span style="color:#f92672">.&lt;/span>environ&lt;span style="color:#f92672">.&lt;/span>setdefault(&lt;span style="color:#e6db74">&amp;#34;DJANGO_SETTINGS_MODULE&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;web.settings&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>application &lt;span style="color:#f92672">=&lt;/span> get_wsgi_application()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>配置django环境
进入你的网站根目录&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#static files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#前提在你的setting.py文件中设置好STATIC_ROOT目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python manage.py collectstatic
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python manage.py migrate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>修改目录权限为&lt;code>www-data&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo chown www-data:www-data webroot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 如果存在数据库，请同时修改相应权限&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="6">
&lt;li>使网站生效&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>	sudo a2ensite yoursite.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	service apache2 reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></description></item><item><title>xinetd 常用配置</title><link>https://caisong.github.io/posts/xinetd/</link><pubDate>Wed, 07 Jun 2017 21:39:31 +0800</pubDate><guid>https://caisong.github.io/posts/xinetd/</guid><description>&lt;h2 id="介绍">介绍&lt;/h2>



 &lt;blockquote>
 &lt;p>xinetd - the extended Internet services daemon
xinetd performs the same function as inetd: it starts programs that
provide Internet services. Instead of having such servers started at
system initialization time, and be dormant until a connection request
arrives, xinetd is the only daemon process started and it listens on
all service ports for the services listed in its configuration file.
When a request comes in, xinetd starts the appropriate server. Because
of the way it operates, xinetd (as well as inetd) is also referred to
as a super-server.
&amp;lt;! &amp;ndash; more &amp;ndash;&amp;gt;
The services listed in xinetd’s configuration file can be separated
into two groups. Services in the first group are called multi-threaded
and they require the forking of a new server process for each new con-
nection request. The new server then handles that connection. For
such services, xinetd keeps listening for new requests so that it can
spawn new servers. On the other hand, the second group includes ser-
vices for which the service daemon is responsible for handling all new
connection requests. Such services are called single-threaded and
xinetd will stop handling new requests for them until the server dies.
Services in this group are usually datagram-based.&lt;/p></description></item><item><title>启动时设置IP</title><link>https://caisong.github.io/posts/set-ip-addr-on-boot/</link><pubDate>Mon, 13 Mar 2017 22:29:19 +0800</pubDate><guid>https://caisong.github.io/posts/set-ip-addr-on-boot/</guid><description>&lt;h2 id="update-rcd">update-rc.d&lt;/h2>
&lt;ul>
&lt;li>the script (setipaddr.sh)&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#! /bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>PATH&lt;span style="color:#f92672">=&lt;/span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:$PATH
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ifconfig eth0 192.168.10.1/24
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>update-rc.d setting&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>chmod +x setipaddr.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mv setipaddr.sh /etc/init.d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>update-rc.d setipaddr.sh defaults
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>run level&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># If defaults is used then update-rc.d will make links to start the service in runlevels 2345 and to stop the service in runlevels 016&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>runlevel &lt;span style="color:#75715e"># get current level&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="systemctl">systemctl&lt;/h2>
&lt;ul>
&lt;li>service file (/etc/systemd/system/setipaddr.service)&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>Unit&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Description&lt;span style="color:#f92672">=&lt;/span>set ip on boot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>After&lt;span style="color:#f92672">=&lt;/span>network.target
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>Service&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Type&lt;span style="color:#f92672">=&lt;/span>oneshot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ExecStart&lt;span style="color:#f92672">=&lt;/span>/opt/bin/setipaddr.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>Install&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>WantedBy&lt;span style="color:#f92672">=&lt;/span>multi-user.target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>systemctl setting&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>systemctl enable setipaddr.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>